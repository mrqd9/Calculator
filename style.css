*{box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html,body{margin:0;height:100%;overflow:hidden;background:#1a1a1a;font-family:'Segoe UI',Roboto,sans-serif;}

.calc{height:100dvh;padding:6px;background:#1a1a1a;display:flex;flex-direction:column;gap:4px;}

/* Action Bar */
.action-bar{display:flex;justify-content:flex-end;gap:15px;padding:0 5px 2px;}
.action-bar button{background:transparent;border:none;color:#81c784;cursor:pointer;padding:2px;display:flex;align-items:center;}

/* Display Area */
.display{flex:1;min-height:0;background:linear-gradient(165deg,#e0e9da,#bdc9b6);border-radius:18px;padding:10px;display:flex;flex-direction:column;box-shadow:inset 0 2px 5px rgba(255,255,255,0.5),0 8px 25px rgba(0,0,0,0.4);}

.history{flex:1;min-height:0;overflow-y:auto;display:flex;flex-direction:column;gap:3px;padding-right:2px;}
.history::-webkit-scrollbar{width:2px;}
.history::-webkit-scrollbar-thumb{background:rgba(0,0,0,0.1);border-radius:10px;}

/* Fixed 65/35 Ratio for History Rows */
.h-row{
  position:relative;
  display:flex;
  align-items:center;
  padding:4px 8px;
  min-height:32px;
  border-radius:8px;
  background:rgba(255,255,255,0.25);
  backdrop-filter:blur(8px);
  border:1px solid rgba(255,255,255,0.1);
  transition: all 0.2s ease;
  user-select:none;
  touch-action:pan-y;
  margin-bottom: 2px;
}

.h-exp{
  flex: 0 0 65%; /* Fixed 65% width */
  text-align: left;
  font-size: 13px;
  color: #444;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 5px;
}

.h-res{
  flex: 0 0 35%; /* Fixed 35% width */
  text-align: right;
  font-size: 15px;
  font-weight: 700;
  color: #1a1a1a;
  border-left: 1px solid rgba(0,0,0,0.1);
  padding-left: 5px;
}

/* Expansion Logic */
.h-row.expanded {
  flex-direction: column;
  align-items: stretch;
  height: auto;
  padding: 10px;
  background: rgba(255,255,255,0.6);
  z-index: 5;
}
.h-row.expanded .h-exp {
  flex: 1;
  white-space: normal;
  border-bottom: 1px solid rgba(0,0,0,0.1);
  padding-bottom: 5px;
  margin-bottom: 5px;
}
.h-row.expanded .h-res {
  flex: 1;
  border-left: none;
  font-size: 18px;
}

/* Swipe and UI Helpers */
.h-row::before{content:"Delete ‚Üê";position:absolute;inset:0;background:#d32f2f;color:white;display:flex;align-items:center;justify-content:flex-end;padding-right:15px;font-weight:600;opacity:0;transition:opacity 0.1s ease;border-radius:8px;}
.h-row.swiping::before{opacity:1;}
.h-row.swiping .h-exp,.h-row.swiping .h-res{opacity:0;}

.negative{color:#c62828!important;}
.separator{height:1px;background:rgba(0,0,0,0.08);margin:4px 0;flex-shrink:0;}

.live{min-height:26px;max-height:65px;overflow-y:auto;text-align:center;font-size:20px;font-weight:600;color:#333;word-wrap:break-word;line-height:1.1;}
.total{height:32px;text-align:right;font-size:26px;font-weight:800;color:#000;flex-shrink:0;}

.caret{display:inline-block;width:2px;height:0.9em;background:#2e7d32;margin-left:2px;vertical-align:-0.15em;animation:blink 1s steps(1) infinite;}
@keyframes blink{50%{opacity:0;}}

/* Keys */
.keys{display:grid;grid-template-columns:repeat(4,1fr);gap:6px;flex-shrink:0;}
button{height:50px;border:0;border-radius:12px;font-size:22px;font-weight:600;color:#efefef;background:#333;box-shadow:0 3px 0 #1a1a1a,0 6px 12px rgba(0,0,0,0.2);transition:all 0.05s;}
button:active{transform:translateY(2px);box-shadow:0 1px 0 #1a1a1a,0 3px 6px rgba(0,0,0,0.3);}

.num{background:#3d3d3d;}
.op{background:#4a4a4a;color:#81c784;}
.ac{background:#b71c1c;color:#fff;}
.eq{grid-column:span 2;background:#2e7d32;color:#fff;}

/* Modal */
.modal{display:none;position:fixed;z-index:100;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,0.85);backdrop-filter:blur(5px);}
.modal-content{background:#bdc9b6;margin:8% auto;padding:15px;border-radius:20px;width:92%;max-height:85vh;display:flex;flex-direction:column;}
.modal-header{display:flex;justify-content:space-between;align-items:center;font-weight:800;font-size:18px;margin-bottom:10px;}
.archive-list{overflow-y:auto;display:flex;flex-direction:column;gap:12px;}
.archive-item{background:rgba(255,255,255,0.4);padding:10px;border-radius:12px;}

@media print{.keys,.action-bar,.caret,.modal{display:none!important;}.calc{padding:0;}.display{box-shadow:none;background:white;}}
